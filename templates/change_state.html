<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Device State Management</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-4">
    <h2>Device State: {{ device_id }}</h2>
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}
    <form method="post">
        <div class="mb-3">
            <label for="current_state" class="form-label">Current State</label>
            <input type="text" class="form-control" id="current_state" name="current_state" value="{{ current_state }}" readonly>
        </div>
        <div class="mb-3">
            <label for="requested_state" class="form-label">Request New State</label>
            <select class="form-select" id="requested_state" name="requested_state">
                <option value="">-- Select State --</option>
                {% for state in possible_states %}
                    <option value="{{ state }}" {% if state == requested_state %}selected{% endif %}>{{ state }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="requested_state_start" class="form-label">Requested State Start</label>
            <input type="datetime-local" class="form-control" id="requested_state_start" name="requested_state_start" value="{% if requested_state_start %}{{ requested_state_start | datetimeformat }}{% endif %}">
        </div>
        <div class="mb-3">
            <label for="requested_state_expire" class="form-label">Requested State Expire</label>
            <input type="datetime-local" class="form-control" id="requested_state_expire" name="requested_state_expire" value="{% if requested_state_expire %}{{ requested_state_expire | datetimeformat }}{% endif %}">
        </div>
        <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="save_dates" name="save_dates" {% if save_dates %}checked{% endif %}>
            <label class="form-check-label" for="save_dates">Save dates with requested state</label>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</div>
</body>
</html>
